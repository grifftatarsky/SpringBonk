<section class="rounded-3xl border border-emerald-400/20 bg-black/80 px-4 py-10 text-white shadow-[0_0_30px_rgba(16,185,129,0.2)] sm:px-8">
  <p class="text-xs font-semibold uppercase tracking-[0.5em] text-emerald-300">Shelves</p>
  <h1 class="mt-3 text-3xl font-semibold tracking-tight sm:text-4xl">Shelf command center</h1>
  <p class="mt-4 max-w-3xl text-sm text-white/70">
    Browse every shelf in your library, jump into detail views, and keep track of which ones are powering
    nominations or club reads. Use the filters below to slice by name or creation date.
  </p>
</section>

<div class="mt-8">
  @let state = vm();
  <app-paginated-list
    title="All shelves"
    [page]="state.page"
    [filterValue]="state.filter"
    filterPlaceholder="Filter by shelf name"
    [busy]="state.busy"
    [hasItems]="!!state.items.length"
    [emptyMessage]="state.filter ? 'No shelves match your filter.' : 'Create a shelf from the dashboard to get started.'"
    [showPageSize]="true"
    [pageSizeOptions]="[4, 8, 12]"
    (filterValueChange)="onFilterChange($event)"
    (pageChange)="onPage($event)"
    (pageSizeChange)="onPageSize($event)">

    <div list-actions class="flex w-full flex-col gap-3 text-white/80 sm:w-auto sm:flex-row sm:items-center sm:justify-end">
      <label class="text-xs uppercase tracking-[0.4em] text-white/50">Sort</label>
      <select class="rounded-full border border-white/10 bg-black/60 px-3 py-1 text-sm"
              (change)="updateSort($any($event.target).selectedIndex)"
              aria-label="Sort shelves">
        @for (option of state.sortOptions; track option.label; let i = $index) {
          <option [selected]="option.field === state.sortField && option.direction === state.sortDirection">
            {{ option.label }}
          </option>
        }
      </select>
    </div>

    <ul class="flex flex-col gap-4">
      @for (shelf of state.items; track shelf.id) {
        <li>
          <a [routerLink]="['/shelves', shelf.id]"
             class="group block rounded-3xl border border-white/10 bg-white/5 px-5 py-4 text-white transition hover:-translate-y-0.5 hover:border-emerald-300/60 hover:bg-emerald-500/10">
            <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
              <div>
                <p class="text-xl font-semibold tracking-tight">
                  {{ shelf.title }}
                  <span *ngIf="shelf.defaultShelf"
                        class="ml-2 rounded-full border border-emerald-400/40 px-2 py-0.5 text-xs uppercase tracking-[0.4em] text-emerald-200">
                    Default
                  </span>
                </p>
                <p class="text-sm text-white/60">Created {{ shelf.createdDate | date: 'mediumDate' }}</p>
              </div>
              <div class="flex items-center gap-3 text-xs uppercase tracking-[0.4em] text-white/60">
                <span>{{ shelf.bookCount }} books</span>
                <span class="inline-flex items-center justify-center rounded-full border border-white/15 px-3 py-1 text-white/80">
                  Details â†’
                </span>
              </div>
            </div>
          </a>
        </li>
      }
    </ul>
  </app-paginated-list>

  @if (state.error) {
    <p class="mt-3 rounded-2xl border border-red-400/40 bg-red-500/10 px-4 py-3 text-sm text-red-200" role="status">
      {{ state.error }}
    </p>
  }
</div>
