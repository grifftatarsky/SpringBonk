<div class="max-w-screen overflow-x-hidden">

  <!-- HEADER -->
  <div class="fixed inset-x-0 top-0 z-10 border-b border-black/5 dark:border-white/10">
    <div class="bg-white dark:bg-gray-950">
      <div class="flex h-14 items-center justify-between gap-8 px-4 sm:px-6">
        <div class="flex items-center gap-4">
          <a class="flex items-center gap-2" aria-label="Home" routerLink="/">
            <img
              class="shrink-0"
              ngSrc="small_wordmark-min.svg"
              alt="Akira logo"
              width="36" height="36"
              priority>
            <span class="text-gray-950 dark:text-white font-medium">Akira</span>
          </a>
        </div>

        <!-- HEADER MENU (DESKTOP) -->
        <div class="flex items-center gap-6 max-md:hidden">
          @for (link of navLinks; track link.href) {
            <!-- TODO: this shouldn't just be for all external links. We need to make this a comp, and have optional images.-->
            @if (link.external) {
              <a class="inline-flex" [href]="link.href"
                 [attr.aria-label]="link.ariaLabel ?? link.label" target="_blank" rel="noreferrer">
                <svg viewBox="0 0 20 20" class="size-5 fill-black/40 dark:fill-gray-400">
                  <path
                    d="M10 0C4.475 0 0 4.475 0 10a9.994 9.994 0 006.838 9.488c.5.087.687-.213.687-.476 0-.237-.013-1.024-.013-1.862-2.512.463-3.162-.612-3.362-1.175-.113-.287-.6-1.175-1.025-1.412-.35-.188-.85-.65-.013-.663.788-.013 1.35.725 1.538 1.025.9 1.512 2.337 1.087 2.912.825.088-.65.35-1.088.638-1.338-2.225-.25-4.55-1.112-4.55-4.937 0-1.088.387-1.987 1.025-2.688-.1-.25-.45-1.274.1-2.65 0 0 .837-.262 2.75 1.026a9.28 9.28 0 012.5-.338c.85 0 1.7.112 2.5.337 1.912-1.3 2.75-1.024 2.75-1.024.55 1.375.2 2.4.1 2.65.637.7 1.025 1.587 1.025 2.687 0 3.838-2.337 4.688-4.562 4.938.362.312.675.912.675 1.85 0 1.337-.013 2.412-.013 2.75 0 .262.188.574.688.474A10.016 10.016 0 0020 10c0-5.525-4.475-10-10-10z"></path>
                </svg>
              </a>
            } @else {
              <a class="text-sm/6 text-gray-950 dark:text-white" [routerLink]="link.href">
                {{ link.label }}
              </a>
            }
          }
          <div class="h-6 w-px bg-gray-950/10 dark:bg-white/10"></div>
          <app-auth />
        </div>
        <div class="flex items-center gap-2.5 md:hidden">
          <button type="button"
                  class="relative inline-grid size-7 place-items-center rounded-md text-gray-950 hover:bg-gray-950/5 dark:text-white dark:hover:bg-white/10"
                  aria-label="Navigation" aria-haspopup="true"
                  [attr.aria-expanded]="mobileMenuOpen()"
                  [attr.aria-controls]="mobileMenuId"
                  (click)="toggleMobileMenu()"><span
            class="absolute top-1/2 left-1/2 size-11 -translate-1/2 pointer-fine:hidden"></span>
            <svg viewBox="0 0 16 16" fill="currentColor" class="size-4">
              <path
                d="M8 2a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM8 6.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM9.5 12.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
            </svg>
          </button>
          <div class="h-6 mr-2.5 w-px bg-gray-950/10 dark:bg-white/10"></div>
          <app-auth />
        </div>
      </div>
    </div>
  </div>

  <!-- CONTENT -->
  <div
    class="grid min-h-dvh grid-cols-1 grid-rows-[1fr_1px_auto_1px_auto] justify-center pt-14.25 [--gutter-width:2.5rem] md:-mx-4 md:grid-cols-[var(--gutter-width)_minmax(0,var(--breakpoint-2xl))_var(--gutter-width)] lg:mx-0">

    <!-- BREAKER LEFT -->
    <div
      class="col-start-1 row-span-full row-start-1 hidden border-x border-x-(--pattern-fg) bg-[image:repeating-linear-gradient(315deg,_var(--pattern-fg)_0,_var(--pattern-fg)_1px,_transparent_0,_transparent_50%)] bg-[size:10px_10px] bg-fixed [--pattern-fg:var(--color-black)]/5 md:block dark:[--pattern-fg:var(--color-white)]/10">
    </div>

    <!-- CONTAINER A -->
    <div class="grid gap-24 pb-24 text-gray-950 sm:gap-40 md:pb-40 dark:text-white">
      <router-outlet class="contents"></router-outlet>
    </div>

    <!-- FOOTER -->
    <div
      class="row-span-full row-start-1 hidden border-x border-x-(--pattern-fg) bg-[image:repeating-linear-gradient(315deg,_var(--pattern-fg)_0,_var(--pattern-fg)_1px,_transparent_0,_transparent_50%)] bg-[size:10px_10px] bg-fixed [--pattern-fg:var(--color-black)]/5 md:col-start-3 md:block dark:[--pattern-fg:var(--color-white)]/10"></div>
    <div
      class="col-start-1 row-start-3 md:col-start-2 relative before:absolute before:top-0 before:h-px before:w-[200vw] before:bg-gray-950/5 dark:before:bg-white/10 before:-left-[100vw] after:absolute after:bottom-0 after:h-px after:w-[200vw] after:bg-gray-950/5 dark:after:bg-white/10 after:-left-[100vw]">
      <footer class="bg-white text-sm/loose text-gray-950 dark:bg-gray-900 dark:text-white">
        <div class="flex gap-4 p-4 md:hidden *:first:border-l-0 *:last:border-r-0">
          <div class="flex flex-1 flex-col gap-10">
            <div>
              <!-- MOBILE -->
              <h3 class="font-semibold">Akira</h3>

              <ul class="mt-4 grid gap-4">
                <li><a class="hover:underline" routerLink="/docs">Documentation</a></li>
                <li><a class="hover:underline" routerLink="/dashboard">Dashboard</a></li>
                <li><a class="hover:underline" routerLink="/shelves">Shelves</a></li>
                <li><a class="hover:underline" routerLink="/elections">Elections</a></li>
                <li><a class="hover:underline" routerLink="/books/ol12345m">Book detail demo</a></li>
              </ul>
            </div>
            <div>
              <h3 class="font-semibold">Resources</h3>
              <ul class="mt-4 grid gap-4">
                <li>
                  <a class="hover:underline"
                     href="https://en.wikipedia.org/wiki/Social_choice_theory">
                    Social Choice Theory
                  </a>
                </li>
              </ul>
            </div>
          </div>
          <div class="flex flex-1 flex-col gap-10">
            <div>
              <h3 class="mb-2 font-semibold">Case Studies</h3>
              <ul class="mt-4 grid gap-4">
                <li>
                  <a class="hover:underline" [routerLink]="['/docs']" fragment="case-study">Bonk! Book Club</a>
                </li>
              </ul>
            </div>
            <div>
              <h3 class="font-semibold">Community</h3>
              <ul class="mt-4 grid gap-4">
                <li>
                  <a class="hover:underline" href="https://github.com/grifftatarsky/SpringBonk">GitHub</a>
                </li>
                <!-- TODO: Add a sponsorship/insider program -->
                <li><a class="hover:underline" href="">Discord</a></li>
                <li><a class="hover:underline"
                       href="https://bsky.app/profile/micro-gpt.bsky.social">Bluesky</a></li>
              </ul>
            </div>
          </div>
        </div>
        <!-- DESKTOP -->
        <div
          class="mx-auto hidden w-full grid-cols-4 justify-between gap-y-0 md:grid md:grid-cols-4 md:gap-6 md:gap-x-4 lg:gap-8 *:first:border-l-0 *:last:border-r-0">
          <div
            class="border-x border-b border-gray-950/5 py-10 pl-2 not-md:border-0 md:border-b-0 dark:border-white/10">
            <h3 class="font-semibold">AKIRA</h3>
            <ul class="mt-4 grid gap-4">
              <li><a class="hover:underline" routerLink="/docs">Documentation</a></li>
              <li><a class="hover:underline" routerLink="/dashboard">Dashboard</a></li>
              <li><a class="hover:underline" routerLink="/shelves">Shelves</a></li>
              <li><a class="hover:underline" routerLink="/elections">Elections</a></li>
              <li><a class="hover:underline" routerLink="/books/ol12345m">Book detail demo</a></li>
            </ul>
          </div>
          <div
            class="border-x border-b border-gray-950/5 py-10 pl-2 not-md:border-0 md:border-b-0 dark:border-white/10">
            <h3 class="mb-2 font-semibold">Case Studies</h3>
            <ul class="mt-4 grid gap-4">
              <li>
                <a class="hover:underline" [routerLink]="['/docs']" fragment="case-study">Bonk! Book Club</a>
              </li>
            </ul>
          </div>
          <div
            class="border-x border-b border-gray-950/5 py-10 pl-2 not-md:border-0 sm:border-b-0 dark:border-white/10">
            <h3 class="font-semibold">Resources</h3>
            <ul class="mt-4 grid gap-4">
              <li>
                <a class="hover:underline"
                   href="https://en.wikipedia.org/wiki/Social_choice_theory">
                  Social Choice Theory
                </a>
              </li>
            </ul>
          </div>
          <div class="border-x border-gray-950/5 py-10 pl-2 not-md:border-0 dark:border-white/10">
            <h3 class="font-semibold">Community</h3>
            <ul class="mt-4 grid gap-4">
              <li>
                <a class="hover:underline"
                   href="https://github.com/grifftatarsky/SpringBonk">GitHub</a>
              </li>
              <!-- TODO: See above, add insider/whatever program -->
              <li><a class="hover:underline" href="">Discord</a></li>
              <li><a class="hover:underline" href="https://bsky.app/profile/micro-gpt.bsky.social">Bluesky</a>
              </li>
            </ul>
          </div>
        </div>
      </footer>
    </div>
    <div class="col-start-1 row-start-5 grid md:col-start-2">
      <div class="px-2 pt-10 pb-24">
        <div
          class="mx-auto flex w-full flex-col items-start gap-6 sm:flex-row sm:items-center sm:justify-between sm:gap-8 px-4 md:px-6 lg:px-8">
          <div
            class="relative z-0 inline-grid grid-cols-3 gap-0.5 rounded-full bg-gray-950/5 p-0.75 text-gray-950 dark:bg-white/10 dark:text-white"
            role="radiogroup"
            aria-label="Theme preference">
            @for (option of themeOptions; track option.value) {
              <button type="button"
                      class="rounded-full p-1.5 *:size-7 data-checked:bg-white data-checked:ring data-checked:inset-ring data-checked:ring-gray-950/10 data-checked:inset-ring-white/10 sm:p-0 dark:data-checked:bg-gray-700 dark:data-checked:text-white dark:data-checked:ring-transparent"
                      [attr.aria-label]="option.label + ' theme'"
                      role="radio"
                      [attr.aria-checked]="themePreference() === option.value"
                      [attr.tabindex]="themePreference() === option.value ? 0 : -1"
                      [attr.data-checked]="themePreference() === option.value ? '' : null"
                      (click)="setThemePreference(option.value)">
                @if (option.value === 'system') {
                  <svg viewBox="0 0 28 28" fill="none">
                    <path
                      d="M7.5 8.5C7.5 7.94772 7.94772 7.5 8.5 7.5H19.5C20.0523 7.5 20.5 7.94772 20.5 8.5V16.5C20.5 17.0523 20.0523 17.5 19.5 17.5H8.5C7.94772 17.5 7.5 17.0523 7.5 16.5V8.5Z"
                      stroke="currentColor"></path>
                    <path
                      d="M7.5 8.5C7.5 7.94772 7.94772 7.5 8.5 7.5H19.5C20.0523 7.5 20.5 7.94772 20.5 8.5V14.5C20.5 15.0523 20.0523 15.5 19.5 15.5H8.5C7.94772 15.5 7.5 15.0523 7.5 14.5V8.5Z"
                      stroke="currentColor"></path>
                    <path
                      d="M16.5 20.5V17.5H11.5V20.5M16.5 20.5H11.5M16.5 20.5H17.5M11.5 20.5H10.5"
                      stroke="currentColor" stroke-linecap="round"></path>
                  </svg>
                } @else if (option.value === 'light') {
                  <svg viewBox="0 0 28 28" fill="none">
                    <circle cx="14" cy="14" r="3.5" stroke="currentColor"></circle>
                    <path d="M14 8.5V6.5" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M17.889 10.1115L19.3032 8.69727" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M19.5 14L21.5 14" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M17.889 17.8885L19.3032 19.3027" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M14 21.5V19.5" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M8.69663 19.3029L10.1108 17.8887" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M6.5 14L8.5 14" stroke="currentColor" stroke-linecap="round"></path>
                    <path d="M8.69663 8.69711L10.1108 10.1113" stroke="currentColor" stroke-linecap="round"></path>
                  </svg>
                } @else {
                  <svg viewBox="0 0 28 28" fill="none">
                    <path
                      d="M10.5 9.99914C10.5 14.1413 13.8579 17.4991 18 17.4991C19.0332 17.4991 20.0176 17.2902 20.9132 16.9123C19.7761 19.6075 17.109 21.4991 14 21.4991C9.85786 21.4991 6.5 18.1413 6.5 13.9991C6.5 10.8902 8.39167 8.22304 11.0868 7.08594C10.7089 7.98159 10.5 8.96597 10.5 9.99914Z"
                      stroke="currentColor" stroke-linejoin="round"></path>
                    <path
                      d="M16.3561 6.50754L16.5 5.5L16.6439 6.50754C16.7068 6.94752 17.0525 7.29321 17.4925 7.35607L18.5 7.5L17.4925 7.64393C17.0525 7.70679 16.7068 8.05248 16.6439 8.49246L16.5 9.5L16.3561 8.49246C16.2932 8.05248 15.9475 7.70679 15.5075 7.64393L14.5 7.5L15.5075 7.35607C15.9475 7.29321 16.2932 6.94752 16.3561 6.50754Z"
                      fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path
                      d="M20.3561 11.5075L20.5 10.5L20.6439 11.5075C20.7068 11.9475 21.0525 12.2932 21.4925 12.3561L22.5 12.5L21.4925 12.6439C21.0525 12.7068 20.7068 13.0525 20.6439 13.4925L20.5 14.5L20.3561 13.4925C20.2932 13.0525 19.9475 12.7068 19.5075 12.6439L18.5 12.5L19.5075 12.3561C19.9475 12.2932 20.2932 11.9475 20.3561 11.5075Z"
                      fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                }
              </button>
            }
          </div>
          <div
            class="flex flex-col gap-4 text-sm/6 text-gray-700 sm:flex-row sm:gap-2 sm:pr-4 dark:text-gray-400">
            <span>Copyright ©&nbsp;2025&nbsp; MicroGPT</span>
            <span class="max-sm:hidden">·</span>
            <a class="hover:underline" href="/brand">Trademark Policy</a>
          </div>
        </div>
      </div>
    </div>

    <!-- BREAKER RIGHT -->
    <div
      class="row-span-full row-start-1 hidden border-x border-x-(--pattern-fg) bg-[image:repeating-linear-gradient(315deg,_var(--pattern-fg)_0,_var(--pattern-fg)_1px,_transparent_0,_transparent_50%)] bg-[size:10px_10px] bg-fixed [--pattern-fg:var(--color-black)]/5 md:col-start-3 md:block dark:[--pattern-fg:var(--color-white)]/10">
    </div>

  </div>
</div>

<!-- MOBILE MENU -->
@if (mobileMenuOpen()) {
  <div class="fixed inset-0 z-50 md:hidden" role="dialog" aria-modal="true"
       [attr.aria-labelledby]="mobileMenuId + '-title'">
    <div class="absolute inset-0 bg-gray-950/70 backdrop-blur-sm"
         (click)="closeMobileMenu()" aria-hidden="true"></div>
    <div class="absolute inset-y-0 right-0 flex w-full">
      <div
        class="flex size-full flex-col overflow-y-auto bg-white px-4 sm:px-6 dark:bg-gray-950"
        [attr.id]="mobileMenuId">
        <div class="flex h-14 items-center justify-between">
          <img ngSrc="small_wordmark-min.svg"
               alt="Akira logo"
               width="36" height="36"
               priority>
          <button type="button"
                  class="relative inline-grid size-7 place-items-center rounded-md text-gray-950 hover:bg-gray-950/5 dark:text-white dark:hover:bg-white/10"
                  aria-label="Close navigation"
                  (click)="closeMobileMenu()"><span
            class="absolute top-1/2 left-1/2 size-11 -translate-1/2 pointer-fine:hidden"></span>
            <svg viewBox="0 0 16 16" fill="currentColor" class="size-4">
              <path
                d="M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z"></path>
            </svg>
          </button>
        </div>
        <p class="sr-only" [attr.id]="mobileMenuId + '-title'">Main navigation</p>
        <nav class="grid grid-cols-1 gap-1 px-1 pb-1 pt-4 sm:px-3 sm:pb-3"
             aria-label="Mobile navigation">
          @for (link of navLinks; track link.href) {
            @if (link.external) {
              <a
                class="rounded-lg py-2 text-xl/9 font-medium text-gray-950 data-active:bg-gray-950/5 dark:text-white dark:hover:bg-white/10"
                [href]="link.href" target="_blank" rel="noreferrer" (click)="closeMobileMenu()">
                {{ link.label }}
              </a>
            } @else {
              <a
                class="rounded-lg py-2 text-xl/9 font-medium text-gray-950 data-active:bg-gray-950/5 dark:text-white dark:hover:bg-white/10"
                [routerLink]="link.href" (click)="closeMobileMenu()">
                {{ link.label }}
              </a>
            }
          }
        </nav>
      </div>
    </div>
  </div>
}

<app-toast-container />
