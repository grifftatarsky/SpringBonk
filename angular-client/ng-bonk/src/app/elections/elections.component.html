<mat-toolbar id="toolbar-shelves" class="gap-2">
  <button mat-icon-button (click)="refresh()" aria-label="Refresh elections">
    <mat-icon>refresh</mat-icon>
  </button>
  <div class="toolbar-divider" aria-hidden="true">&nbsp;</div>
  <button mat-button (click)="openCreateDialog()" aria-label="Create election">
    <mat-icon>how_to_vote</mat-icon>
    Add Election
  </button>
  <div class="spacer"></div>
</mat-toolbar>

@if (loading$ | async) {
  <div>
    <mat-progress-bar mode="indeterminate" />
  </div>
}

<div class="elections-layout">
  <div
    class="list-pane"
    #listContainer
    [class.mobile-hidden]="hasSelection$ | async"
    (scroll)="onListScroll($event)">
    <div class="elections-list">
      @if (elections$ | async; as elections) {
        @if (elections.length > 0) {
          @for (e of elections; track e) {
            <mat-card
              class="election-card"
              [class.active]="(selectedId$ | async) === e.id"
              tabindex="0"
              role="button">
              <div
                class="election-card-body"
                matRipple
                [matRippleColor]="'rgba(0,255,65,0.3)'"
                [matRippleCentered]="true"
                (click)="navigateToDetail(e.id)">
                <div class="election-title">{{ e.title }}</div>
                @if (getStatus(e.endDateTime); as status) {
                  <div class="election-status">
                    <mat-chip
                      [ngClass]="status.class"
                      disableRipple
                      [matTooltip]="
                        status.text === 'Ongoing'
                          ? 'Ends ' + (e.endDateTime | date: 'short')
                          : ''
                      ">
                      <mat-icon matChipAvatar inline>{{
                        status.icon
                      }}</mat-icon>
                      {{ status.text }}
                    </mat-chip>
                  </div>
                }
              </div>
            </mat-card>
          }
        } @else {
          @if (!(loading$ | async)) {
            <mat-card class="election-card">
              <div class="election-card-body">
                <div class="election-title">No elections</div>
              </div>
            </mat-card>
          }
        }
      }
    </div>
  </div>
  <div class="detail-pane" [class.mobile-shown]="hasSelection$ | async">
    <router-outlet></router-outlet>
  </div>
</div>

<!-- Removed old emptyState template; empty handled above -->
