<mat-toolbar color="primary">
  <button mat-icon-button class="mobile-back-button" routerLink="/shelves">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <span>{{ (shelf$ | async)?.title }}</span>
  <span class="spacer"></span>
  @if ((shelf$ | async)?.defaultShelf) {
    <span class="default-badge">Default</span>
  }
  <span class="count-badge" *ngIf="total$ | async as total">{{ total }}</span>
</mat-toolbar>

<div class="shelf-content">
  @if (loading$ | async) {
    <div>
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
  }
  @if (displayedBooks$ | async; as books) {
    @if (books.length > 0) {
      <div class="book-cards" (scroll)="onDetailScroll($event)">
        @for (book of books; track trackByBookId($index, book)) {
          <mat-card class="book-card" (click)="openBookSheet(book)">
            <div class="cover">
              <app-book-cover
                [src]="book.imageURL"
                [alt]="book.title + ' cover'"></app-book-cover>
            </div>
            <div class="meta">
              <div class="title">{{ book.title }}</div>
              <mat-chip-set>
                <mat-chip appearance="outlined">{{ book.author }}</mat-chip>
                <mat-chip appearance="outlined">{{
                  book.publishedYear ?? 'â€”'
                }}</mat-chip>
              </mat-chip-set>
            </div>
            <div class="actions" (click)="$event.stopPropagation()">
              <button
                mat-icon-button
                aria-label="Book details"
                (click)="openBookSheet(book)">
                <mat-icon>info</mat-icon>
              </button>
            </div>
          </mat-card>
        }
      </div>
    } @else {
      <div class="no-data">This shelf has no books yet.</div>
    }
  }
</div>
