<div class="dialog-shell" *ngIf="book as current">
  <div class="book-summary">
    <div class="cover">
      <app-book-cover [src]="current.imageURL" [alt]="current.title"></app-book-cover>
    </div>
    <div class="details">
      <h3>{{ current.title }}</h3>
      <p class="author">{{ current.author }}</p>
    </div>
  </div>

  <div class="loading" *ngIf="loading">
    <p-progressSpinner strokeWidth="3"></p-progressSpinner>
    <span>Loading electionsâ€¦</span>
  </div>

  <ng-container *ngIf="!loading">
    <div class="empty" *ngIf="elections.length === 0">
      No ongoing elections available for nomination.
    </div>

    <div class="election-form" *ngIf="elections.length > 0">
      <label for="electionSelect">Select an election</label>
      <p-dropdown
        id="electionSelect"
        [options]="elections"
        optionLabel="display"
        optionValue="id"
        [formControl]="electionControl"
        placeholder="Choose an election"
        filter
        class="w-full"
      ></p-dropdown>

      <div *ngIf="selectedElection" class="election-meta">
        <p-tag
          [value]="statusLabel(selectedElection)"
          [severity]="statusSeverity(selectedElection)"
        ></p-tag>
        <span *ngIf="selectedElection.endDateTime">
          Ends {{ selectedElection.endDateTime | date: 'medium' }}
        </span>
      </div>
    </div>
  </ng-container>

  <div class="actions">
    <p-button
      type="button"
      label="Cancel"
      styleClass="p-button-text"
      (onClick)="cancel()"
    ></p-button>
    <p-button
      type="button"
      label="Nominate"
      icon="pi pi-check"
      (onClick)="nominate()"
      [disabled]="electionControl.invalid || loading || nominating"
    ></p-button>
  </div>
</div>
