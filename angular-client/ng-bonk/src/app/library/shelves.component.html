<p-toolbar class="shelves-toolbar">
  <div class="p-toolbar-group-start">
    <button
      pButton
      type="button"
      icon="pi pi-refresh"
      class="p-button-text p-button-rounded"
      aria-label="Refresh shelves"
      (click)="refresh()"
    ></button>
    <button
      pButton
      type="button"
      icon="pi pi-plus"
      label="New Shelf"
      class="p-button-raised"
      (click)="openCreateDialog()"
    ></button>
    <button
      pButton
      type="button"
      icon="pi pi-book"
      label="Add Book"
      class="p-button-outlined"
      (click)="openBookSearch()"
    ></button>
  </div>
  <div class="p-toolbar-group-end shelves-count">
    <span>{{ total$ | async }} shelves</span>
  </div>
</p-toolbar>

<div class="shelves-content">
  <section class="shelf-list" (scroll)="onScroll($event)">
    <ng-container *ngIf="shelves$ | async as shelves; else emptyState">
      <ng-container *ngFor="let shelf of shelves; trackBy: trackByShelfId">
        <p-card
          class="shelf-card"
          [ngClass]="{ active: (selectedId$ | async) === shelf.id }"
          (click)="navigateToShelf(shelf.id)"
        >
          <div class="shelf-card-header">
            <span class="shelf-title">{{ shelf.title }}</span>
            <p-tag
              *ngIf="shelf.defaultShelf"
              value="Default"
              severity="success"
              styleClass="shelf-tag"
            ></p-tag>
          </div>
          <div class="shelf-card-actions">
            <button
              pButton
              type="button"
              icon="pi pi-pencil"
              class="p-button-text p-button-rounded"
              (click)="openEditDialog(shelf); $event.stopPropagation()"
              aria-label="Edit shelf"
            ></button>
            <button
              pButton
              type="button"
              icon="pi pi-trash"
              class="p-button-text p-button-rounded"
              (click)="confirmDelete(shelf); $event.stopPropagation()"
              aria-label="Delete shelf"
            ></button>
          </div>
        </p-card>
      </ng-container>

      <div class="list-loader" *ngIf="loading$ | async">
        <p-progressSpinner strokeWidth="3"></p-progressSpinner>
      </div>
    </ng-container>
  </section>

  <section class="shelf-detail">
    <router-outlet></router-outlet>
  </section>
</div>

<ng-template #emptyState>
  <div class="empty-state">
    <p>No shelves yet. Create your first shelf to get started.</p>
  </div>
</ng-template>
